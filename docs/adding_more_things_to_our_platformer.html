
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adding more Things to our Platformer &#8212; spygame 0.1a8 documentation</title>
    
    <link rel="stylesheet" href="_static/spygame_sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1a8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to code against spygame" href="how_to_code_against_spygame.html" />
    <link rel="prev" title="How to build a Platformer with spygame" href="how_to_build_a_platformer_with_spygame.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="how_to_code_against_spygame.html" title="How to code against spygame"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="how_to_build_a_platformer_with_spygame.html" title="How to build a Platformer with spygame"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">spygame 0.1a8 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Adding more Things to our Platformer</a><ul>
<li><a class="reference internal" href="#converting-our-stairs-into-slopes">Converting our Stairs into Slopes</a></li>
<li><a class="reference internal" href="#fixing-the-foreground-layer-and-preparing-for-ladders">Fixing the Foreground Layer and Preparing for Ladders</a></li>
<li><a class="reference internal" href="#adding-ladders-to-the-levels">Adding Ladders to the Levels</a></li>
<li><a class="reference internal" href="#adding-dangerous-quicksand-to-the-level">Adding Dangerous Quicksand to the Level</a></li>
<li><a class="reference internal" href="#adding-an-additional-viking-to-the-level">Adding an Additional Viking to the Level</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="how_to_build_a_platformer_with_spygame.html"
                        title="previous chapter">How to build a Platformer with spygame</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="how_to_code_against_spygame.html"
                        title="next chapter">How to code against spygame</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/adding_more_things_to_our_platformer.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adding-more-things-to-our-platformer">
<h1>Adding more Things to our Platformer<a class="headerlink" href="#adding-more-things-to-our-platformer" title="Permalink to this headline">¶</a></h1>
<p><strong>IMPORTANT NOTE:</strong> <em>All graphics used in this tutorial were taken from the game “The Lost Vikings” (c) 1992 by Silicon and Synapse
(now Blizzard Entertainment Inc.). Please use these (in your own projects and repos) for demonstration purposes only and then mention this
copyright statement!</em></p>
<p>Welcome back to the advanced spygame level-tmx tutorial, in which we will improve our level from the previous tutorial by adding more exciting things to
it. At the end of this process, our level will look like this:</p>
<img alt="The final spygame game we will be building in this tutorial" src="tutorial/advanced/001_final_spygame_game.png" />
<p>All you need to follow along with the different steps in this tutorial is to copy your project directory from the previous tutorial
(with all its subdirectories and contents) and name the copy of the folder “tutorial_advanced”. Alternatively, you can just keep working with the
already existing project and build all new things on top of it (you will lose some of the pieces of the previous tutorial, but what the heck).</p>
<p>Other than that, the same tools as for the first part are needed (Tiled editor, spygame lib, etc..).</p>
<div class="section" id="converting-our-stairs-into-slopes">
<h2>Converting our Stairs into Slopes<a class="headerlink" href="#converting-our-stairs-into-slopes" title="Permalink to this headline">¶</a></h2>
<p>The first thing we would like to improve in our level is to get rid of the stairs-like structure and instead replace it with a smooth, sloped hill.
We open the tutorial.tmx file in our Tiled editor and go to the Layers panel.</p>
<p><strong>Note:</strong> Make sure you have the
<em>View-&gt;Views and Toolbars-&gt;Tilesets/Objects/Layers/Properties/Main Toolbar/Tools</em> panels all checked to make these visible in your editor.</p>
<p>We go to the Layers panel and make all layers invisible, except for the collision layer and the background layer.
We will also move up the collision layer to the first position in the layers list for better visibility purposes by using the highlighted up-arrow in the image
below. Note that the position in the list of layers
in the Layers panel has no effect on the actual render order in the game. The render order is determined by the custom property render_order (int) for each
layer (that has do_render set to true) and defaults to a value of 50:</p>
<img alt="Moving layers up and down" src="_images/002_moving_layers_up_and_down.png" />
<p>Note that we will now be able to nicely draw collision tiles on top of the background (without hurting the background).
Next, we select the collision layer in the Layers panel and then choose the eraser tool (E)
and erase the staircase in the middle of our level. The level should now look like this:</p>
<img alt="Erasing the staircase of our level (to be replaced with a sloped hill)" src="_images/003_erasing_the_staircase.png" />
<p>In order to use sloped tiles (instead of the fully filled red square), we need to add slope-function properties also to the other tiles in the first row of our
generic tileset. Remember that we already defined such a function for the fully filled red square tile in the first part of the tutorial. We will
now define similar functions for all other red tiles. Starting with the 3rd tile in the first row (the 45° up-slope with ID=2) and then moving tile by tile
to the right, we define a custom “slope” and “offset” property for each of them by right clicking the respective tile, choosing “Tile Properties”,
clicking on the plus symbol at the bottom of the Properties panel and then assigning the following values (remember that both “slope” and “offset” need to be
of type <em>float</em>):</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="39%" />
<col width="27%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ID</th>
<th class="head">Tile</th>
<th class="head">slope</th>
<th class="head">offset</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2</td>
<td>45° up</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>22° up (1)</td>
<td>0.5</td>
<td>0.0</td>
</tr>
<tr class="row-even"><td>4</td>
<td>22° up (2)</td>
<td>0.5</td>
<td>0.5</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>15° up (1)</td>
<td>0.33333</td>
<td>0.0</td>
</tr>
<tr class="row-even"><td>6</td>
<td>15° up (2)</td>
<td>0.33333</td>
<td>0.33333</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>15° up (3)</td>
<td>0.33333</td>
<td>0.66666</td>
</tr>
<tr class="row-even"><td>8</td>
<td>45° down</td>
<td>-1.0</td>
<td>1.0</td>
</tr>
<tr class="row-odd"><td>9</td>
<td>22° down (1)</td>
<td>-0.5</td>
<td>1.0</td>
</tr>
<tr class="row-even"><td>10</td>
<td>22° down (2)</td>
<td>-0.5</td>
<td>0.5</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>15° down (1)</td>
<td>-0.33333</td>
<td>1.0</td>
</tr>
<tr class="row-even"><td>12</td>
<td>15° down (2)</td>
<td>-0.33333</td>
<td>0.66666</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>15° down (3)</td>
<td>-0.33333</td>
<td>0.33333</td>
</tr>
</tbody>
</table>
<p>Next, we will start drawing the slope where the stairs used to be. We start at the bottom with two tiles of slope 22°-up, then we continue til the top with
45° up-tiles. Try to make your level look like this. Remember to select the collision layer in the Layers panel before you draw the new sloped tiles:</p>
<img alt="The new sloped hill" src="_images/004_creating_a_sloped_hill.png" />
<p>Also note the two solid squares (highlighted with a blue x). These are important so that the player will not be able to jump into the sloped tiles from the
back (from within the cave). This would lead to unpredicted behaviors and is currently not supported by spygame’s platformer physics component.</p>
<p>This would be all for slopes. You can play around with the other sloped tiles and add any sloped structure you would like. The only restriction that spygame
currently poses are a) no entering sloped tiles from the back and b) no upside-down slopes (ceiling slopes). Support for these cases may be
added to spygame in the future.</p>
</div>
<div class="section" id="fixing-the-foreground-layer-and-preparing-for-ladders">
<h2>Fixing the Foreground Layer and Preparing for Ladders<a class="headerlink" href="#fixing-the-foreground-layer-and-preparing-for-ladders" title="Permalink to this headline">¶</a></h2>
<p>The next thing we would like to do is to “fix” the foreground layer. Right now, the only thing in this layer is the palm tree. We will make the sloped hill
look nicer with the player moving up the hill as well as prepare for the palm tree to act as a ladder on which the player can climb using the
up and down arrow keys.</p>
<p>We make the foreground layer visible, click on it in the Layers panel and use the eraser tool to remove the palm tree. Then we make the collision layer
invisible, click on the background layer in the Layers panel and use the rectangular selection tool (R) to block-select
the following range of (background) tiles:</p>
<img alt="Selecting a range of tiles from a layer" src="_images/005_selecting_a_range_of_tiles.png" />
<p>Then we press CTRL+X to cut this range of tiles. We then select the foreground layer again in the Layers panel, press CTRL+V and insert the cut tiles now into
the foreground layer.
If we play the game now (run the copied tutorial.py from within the new copied directory), we can see that Erik will now a) be able to walk up the hill
without having to jump thanks to the sloped tiles and b) disappear nicely behind the sandy slopes of the hill because these tiles are now part of the
foreground layer.
We also - sadly - note that the palm tree has been removed. However, we will plant it back now and - even better than before - make a ladder out of it!</p>
<img alt="Erik half sunken in the sand" src="_images/006_erik_disappearing_nicely_in_the_foreground_sand_hill.png" />
</div>
<div class="section" id="adding-ladders-to-the-levels">
<h2>Adding Ladders to the Levels<a class="headerlink" href="#adding-ladders-to-the-levels" title="Permalink to this headline">¶</a></h2>
<p>Ladders in spygame are quite easy to do. They are simply “painted”, meaning they are an integral part of a background layer (of any other layer).
Any tile or group of tiles in any tileset can serve as a ladder. All we have to do is declare a special custom property on the respective tile and then
tell the layer (via yet another custom property) that it should look for ladder tiles to build the spygame.Ladder objects from these.</p>
<p>Here is how this works:
Select the egpt tileset in the Tilesets panel and look for any palm tree. Maybe the one we removed before, but any other will do just as well.
In the egpt tileset, select those tiles that make up the trunk of the palm tree. In the egpt case, this selection should be 2 tiles wide, but other
tilesets may offer ladder tiles of only one tile width. Your selection should look like this:</p>
<img alt="Selecting a bunch of tiles that make up the trunk of a palm tree" src="_images/007_selecting_tiles_that_make_up_trunk.png" />
<p>Then right click this selection and choose “Tile Properties”. This will allow us to set custom properties for all the different tiles in the selection
at the same time. We will add the property “autobuild_class” (string) and set its value to “spygame.Ladder”.
Make sure that every single tile has this property now by clicking tile by tile through the palm tree trunk and checking in the Properties panel for
“type” set to “ladder”. Next we need to use the brush tool (B) to paint the entire palm (not just the trunk) to the background layer:</p>
<img alt="Re-adding the palm tree - this time to the background layer" src="_images/008_re_adding_the_palm_to_the_background.png" />
<p>You could have done the painting step before setting the tile properties (autobuild_class=spygame.Ladder).
Once you set or change a tile’s properties, it will automatically apply to all already placed tiles in all existing layers.</p>
<p>The last thing we need to do is tell the background layer that it should look for ladder tiles when the layer builds itself (during the construction of the
spygame.TiledTileLayer object) and add spygame.Ladder objects for all consecutive tiles of autobuild_class=spygame.Ladder it can find.
This is a fully automated process and all we have to do is set a single custom property in the background layer,
named “autobuild_objects” (bool) and set its value to true.</p>
<p>If we now play the tutorial.py game, Erik should be able to climb up and down the trunk of the palm tree (using the up and down arrow keys):</p>
<img alt="Erik climbing up the palm tree's trunk" src="_images/009_erik_climbing_up_a_ladder.png" />
<p><strong>Exercise:</strong> There are two tiles in the egpt tileset that look like an actual ladder. Can you find them, convert them into ladder
tiles and add a real-looking ladder to your level via the background layer’s build_ladder capabilities? Do it the exact same way as we did with the
palm tree trunk.</p>
<p>Next up: Building our first trap into the depth of our mean-ass pharaoh temple.</p>
</div>
<div class="section" id="adding-dangerous-quicksand-to-the-level">
<h2>Adding Dangerous Quicksand to the Level<a class="headerlink" href="#adding-dangerous-quicksand-to-the-level" title="Permalink to this headline">¶</a></h2>
<p>Liquid surfaces like water or quicksand that cause the player to sink and die can be added to a level in the same way as ladders.
This time, however, we will add the respective tiles to the foreground layer (ladders are usually added to the background layer as the player
is rendered in front of the ladder).
We select all tiles in the egpt tileset that look like quicksand. These are the tiles with the IDs 320, 321, 322, 360, 400, 401, 440, 441, and 481. We can
select all of them at the same time using the mouse and the CTRL key. Then we click on the plus sign in the Properties panel and add the property:
“autobuild_class” (string) with the value “spygame.LiquidBody”.
We then paint (into the foreground layer) the following structure:</p>
<img alt="Adding a quicksand trap to the level" src="_images/010_adding_a_quicksand_trap.png" />
<p>Playing the tutorial.py game should now make Erik die when touching the surface of the quicksand. Let try it out:</p>
<img alt="Poor Erik sinking into the quicksand trap" src="_images/011_erik_sinking_into_the_trap.png" />
<p>The game should end here printing out “Game Over” on the console.</p>
</div>
<div class="section" id="adding-an-additional-viking-to-the-level">
<h2>Adding an Additional Viking to the Level<a class="headerlink" href="#adding-an-additional-viking-to-the-level" title="Permalink to this headline">¶</a></h2>
<p>Now that we have the nicely sloped hill, we no longer rely on our hero being able to jump up the stairs. One can just walk. Therefore Vikings other
than Erik, who are not able to jump (but have other qualities) can enter the scene now. So let’s add Baleog the Fierce, a fearless warrior with sword and
bow.</p>
<p>We have to add a new tileset first, the one for Baleog. Click on <em>Map-&gt;New Tileset</em>, then pick the baleog.png file and make sure the width and height are 32px
each. Click the little Export Tileset As button at the bottom of the Tilesets panel and save the Baloeg tileset as “baleog.tsx” in the data directory
of your project. Select the object layer and - with the Insert Tile (T) tool - insert one Baleog object into the level.
Choose the Select Tool (S) and click on the new Baleog, then set his Type property to “spygame.examples.vikings.Baleog”.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="how_to_code_against_spygame.html" title="How to code against spygame"
             >next</a> |</li>
        <li class="right" >
          <a href="how_to_build_a_platformer_with_spygame.html" title="How to build a Platformer with spygame"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">spygame 0.1a8 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, ducandu GmbH.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>